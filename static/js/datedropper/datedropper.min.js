

	//////////////////////////////////////
	// DATEDROPPER Version 1	    	//
	// Last Updates: 21/02/2015	    	//
	//				    				//
	// Made with love by		    	//
	// Felice Gattuso		    		//
	//////////////////////////////////////
	

$.fn.dateDropper=function(e){if(this.is("input")&&"text"==this.attr("type")){var a=(new Date).getFullYear(),i=(new Date).getDate(),s=(new Date).getMonth(),t=$.extend({animate_current:!0,animation:"fadein",color:"#f87a54",format:"m/d/Y",lang:"en",lock:!1,maxYear:a,minYear:1970,placeholder:"Select date",years_multiple:!1},e),r=this,_=$(".dd_wrap").length+1,o=function(d){return!(d%4||!(d%100)&&d%400)},u=100,f=/^#[0-9A-F]{6}$/i.test(t.color),c=function(d){return d.toString().substr(0,3)+t.years_multiple},v=0;f||(t.color="#f87a54"),t.maxYear<a&&(a=t.maxYear),$('<div class="dd_wrap" id="dd_'+_+'"><div class="dd_overlay"></div><div class="dd_"></div></div>').appendTo("body");var m=$("#dd_"+_),b=m.find(".dd_");if(dd_overlay=m.find(".dd_overlay"),$(window).on("resize",function(){b.css({top:r.offset().top+(r.height()+12),left:r.offset().left+(r.width()/2-u/2)-2})}),$("<style>#dd_"+_+" .dd_ .dd_submit,#dd_"+_+" .dd_ .dd_r_ ul li { background-color: "+t.color+"; } #dd_"+_+" .dd_ .dd_d_ .dd_sl_ ul li em , #dd_"+_+" .dd_ .dd_d_ .dd_sl_ ul li.dd_sunday{ color: "+t.color+"; }</style>").appendTo("head"),r.attr({readonly:"readonly"}).addClass("dd_locked"),r.val()){var p=r.val(),h=p.match(/(?:\d{4}|\d{1,2})/g),g=t.format.match(/[a-zA-Z]+/g),C=null,y=null,k=null;if(h){for(var w=0;w<=h.length;w++)h[w]&&(4==h[w].length?C=h[w]:h[w].length<=2&&h[w].length>0&&(h[w]<=12&&"m"==g[w]||"n"==g[w]?k=h[w]:y=h[w]));10>k&&2==k.length&&(k=k.substr(1)),10>y&&2==y.length&&(y=y.substr(1)),null==y&&(y=i),null==k&&(k=s),null==C&&(C=a)}C<t.minYear&&(t.minYear=C)}else t.placeholder&&r.val(t.placeholder);b.append('<div class="dd_sw_ dd_m_"><a class="dd_nav_ dd_prev_"></a><a class="dd_nav_ dd_next_"></a><div class="dd_sl_"></div></div>'),b.append('<div class="dd_sw_ dd_d_"><a class="dd_nav_ dd_prev_"></a><a class="dd_nav_ dd_next_"></a><div class="dd_sl_"></div></div>'),b.append('<div class="dd_sw_ dd_y_"><a class="dd_nav_ dd_prev_"></a><a class="dd_nav_ dd_next_"></a><div class="dd_sl_"></div></div>'),t.years_multiple&&b.append('<div class="dd_r_"></div>'),b.append('<div class="dd_submit"></div>');var S=b.find(".dd_m_"),J=b.find(".dd_d_"),L=(b.find(".dd_y_w"),b.find(".dd_y_")),A=b.find(".dd_r_"),Y=b.find(".dd_submit");switch(t.lang){case"it":var z=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],T=["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"];break;case"hu":var z=["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],T=["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"];break;case"es":var z=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],T=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"];break;case"de":var z=["Januar","Februar","Marz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],T=["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"];break;case"nl":var z=["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],T=["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"];break;case"fr":var z=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],T=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"];break;case"pt":var z=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],T=["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"];break;case"si":var z=["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],T=["nedelja","ponedeljek","torek","sreda","četrtek","petek","sobota"];break;default:var z=["January","February","March","April","May","June","July","August","September","October","November","December"],T=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}S.find(".dd_sl_").append("<ul></ul>");for(var N=1;12>=N;N++)months=z[N-1].substr(0,3),S.find("ul").append('<li value="'+N+'">'+months+"</li>");J.find(".dd_sl_").append("<ul></ul>");for(var O=1;31>=O;O++)ddd=10>O?"0"+O:O,J.find("ul").append('<li value="'+O+'">'+ddd+"<em ></em></li>");L.find(".dd_sl_").append("<ul></ul>");for(var q=t.minYear;q<=t.maxYear;q++)bissextile_return=o(q),L.find("ul").append('<li value="'+q+'" data-filter="'+bissextile_return+'">'+q+"</li>");if(t.years_multiple){A.append("<ul></ul>");for(var G=t.minYear;G<=t.maxYear;G++){var V=G%t.years_multiple;0==V&&A.find("ul").append('<li value="'+G+'"></li>')}var Q=u/A.find("li").length;A.find("li").css({width:Q+"%"}),A.find("li[value="+c(a)+"]").addClass("dd_sltd_")}var E=function(){J.find("li").eq(i-1).addClass("dd_sltd_"),S.find("li").eq(s).addClass("dd_sltd_"),L.find("li[value="+a+"]").addClass("dd_sltd_"),t.years_multiple&&A.find("li[value="+c(a)+"]").addClass("dd_sltd_")},W=function(){J.find("li").eq(y-1).addClass("dd_sltd_"),S.find("li").eq(k-1).addClass("dd_sltd_"),L.find("li[value="+C+"]").addClass("dd_sltd_"),t.years_multiple&&A.find("li[value="+c(C)+"]").addClass("dd_sltd_")},Z=function(){S.find(".dd_sl_").animate({scrollLeft:S.find("li.dd_sltd_").index()*u},1200,"swing"),setTimeout(function(){J.find(".dd_sl_").animate({scrollLeft:J.find("li.dd_sltd_").index()*u},1200,"swing"),setTimeout(function(){L.find(".dd_sl_").animate({scrollLeft:L.find("li.dd_sltd_").index()*u},1200,"swing")},200)},400)},B=function(){S.find(".dd_sl_").scrollLeft(S.find("li.dd_sltd_").index()*u),J.find(".dd_sl_").scrollLeft(J.find("li.dd_sltd_").index()*u),L.find(".dd_sl_").scrollLeft(L.find("li.dd_sltd_").index()*u)};switch(y||k||C?W():E(),t.format){case"Y":S.hide(),J.hide();break;case"m":L.hide(),A.hide(),J.hide()}var H=function(){var e=J.find("li.dd_sltd_").attr("value"),a=S.find("li.dd_sltd_").attr("value"),l=L.find("li.dd_sltd_").attr("value"),i=A.find("li.dd_sltd_"),s=L.find("li.dd_sltd_").attr("data-filter");"true"==s&&"2"==a?(J.find("ul").width(29*u),(30==e||31==e)&&(J.find("li").removeClass("dd_sltd_"),J.find("li[value=29]").addClass("dd_sltd_"))):"true"!=s&&"2"==a?(J.find("ul").width(28*u),(29==e||30==e||31==e)&&(J.find("li").removeClass("dd_sltd_"),J.find("li[value=28]").addClass("dd_sltd_"))):"11"==a||"4"==a||"6"==a||"9"==a?(J.find("ul").width(30*u),31==e&&(J.find("li").removeClass("dd_sltd_"),J.find("li[value=30]").addClass("dd_sltd_"))):J.find("ul").width(31*u),J.find("li").each(function(){tod=$(this).attr("value"),d=new Date(a+"/"+tod+"/"+l),x=d.getDay(),0==x?$(this).addClass("dd_sunday"):$(this).removeClass("dd_sunday"),$(this).find("em").html(T[x])}),t.years_multiple&&(next=i.next("li"),prev=i.prev("li"),l>=next.attr("value")?(v=next.attr("value"),A.find("li").removeClass("dd_sltd_"),next.addClass("dd_sltd_")):v>l&&(v=prev.attr("value"),A.find("li").removeClass("dd_sltd_"),prev.addClass("dd_sltd_")))},I=function(d){r.val(d),b.addClass("dd_fadeout").removeClass("dd_"+t.animation),setTimeout(function(){b.hide().removeClass("dd_fadeout"),m.hide()},300)},K=function(){b.addClass("dd_alert").removeClass("dd_"+t.animation),setTimeout(function(){b.removeClass("dd_alert")},500)};t.years_multiple&&A.find("li").on("click",function(){A.find("li").removeClass("dd_sltd_"),$(this).addClass("dd_sltd_");var d=$(this).attr("value");v=d,L.find(".dd_sl_").stop().animate({scrollLeft:L.find("li[value="+d+"]").index()*u},1200,"swing"),L.find("li").removeClass("dd_sltd_"),L.find("li[value="+d+"]").addClass("dd_sltd_"),H()}),b.find(".dd_sw_").each(function(){var d=$(this).find(".dd_sl_"),e=$(this).find(".dd_nav_"),a=d.find("li.dd_sltd_").index()*u,l=function(){scroll_left=d.scrollLeft(),scroll_left>=a+u/2&&(a+=u),scroll_left<=a-u/2&&(a-=u)};$(this).hover(function(){e.show()},function(){e.hide()}),d.find("ul").width(d.find("li").length*u),d.on("scroll mousemove",function(){l()}),e.click(function(){obj=$(this).hasClass("dd_next_")?d.find("li.dd_sltd_").next("li"):d.find("li.dd_sltd_").prev("li"),obj.length&&(d.stop().animate({scrollLeft:obj.index()*u},200),d.find("li").removeClass("dd_sltd_"),obj.addClass("dd_sltd_"),H())}),d.on("touchend",function(){d.stop().animate({scrollLeft:a},200);var e=a/u;d.find("li").removeClass("dd_sltd_"),d.find("li").eq(e).addClass("dd_sltd_"),H()}),d.find("li").click(function(){d.animate({scrollLeft:$(this).index()*u},200),d.find("li").removeClass("dd_sltd_"),$(this).addClass("dd_sltd_")})}),H(),r.click(function(){m.show(),b.css({top:r.offset().top+(r.height()+12),left:r.offset().left+(r.width()/2-u/2)-2}).show().addClass("dd_"+t.animation),r.hasClass("dd_locked")?(r.removeClass("dd_locked"),0!=t.animate_current?Z():B()):B()}),dd_overlay.click(function(){b.addClass("dd_fadeout").removeClass("dd_"+t.animation),setTimeout(function(){b.hide().removeClass("dd_fadeout"),m.hide()},300)}),Y.click(function(){var d=J.find("li.dd_sltd_").attr("value"),e=S.find("li.dd_sltd_").attr("value"),r=L.find("li.dd_sltd_").attr("value");if(10>d&&(d="0"+d),10>e&&(e="0"+e),x=new Date(e+"/"+d+"/"+r),x=x.getDay(),j=d.substr(1),D=T[x].substr(0,3),l=T[x],n=10>e?e.substr(1):e,M=z[n-1].substr(0,3),F=z[n-1],str=t.format.replace(/\b(Y)\b/i,r).replace(/\b(m)\b/i,e).replace(/\b(d)\b/i,d).replace(/\b(D)\b/i,D).replace(/\b(j)\b/i,j).replace(/\b(l)\b/i,l).replace(/\b(F)\b/i,F).replace(/\b(M)\b/i,M).replace(/\b(n)\b/i,n),t.lock){d1d=i,d1d<10&&(d1d="0"+d1d),d1m=s+1,d1m<10&&(d1m="0"+d1m),d1y=a;var _=Date.parse(d1y+"-"+d1m+"-"+d1d)/1e3,o=Date.parse(r+"-"+e+"-"+d)/1e3;"from"==t.lock?_>o?K():I(str):o>_?K():I(str)}else I(str)})}};